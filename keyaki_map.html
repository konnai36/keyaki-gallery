
<!DOCTYPE html>
<html>
  <head>
    <title>けやきが丘 ロケ地マップ</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      html, body, #map {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      .info-content {
        max-width: 220px;
        font-size: 14px;
      }
      .info-content img {
        width: 100%;
        margin-top: 0.5em;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      const imageData = [
        { filename: "photo001.jpg", lat: 35.557634, lng: 139.559936 },
        { filename: "photo002.jpg", lat: 35.557609, lng: 139.559870 },
        { filename: "photo003.jpg", lat: 35.557540, lng: 139.559800 }
      ];

      async function initMap() {
        const center = { lat: 35.5575, lng: 139.5606 };
        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 17,
          center,
        });
        const infoWindow = new google.maps.InfoWindow();

        let captions = [];
        try {
          const res = await fetch("captions.json");
          captions = await res.json();
        } catch (e) {
          console.warn("captions.json 読み込み失敗:", e);
        }

        imageData.forEach((item, index) => {
          const marker = new google.maps.Marker({
            position: { lat: item.lat, lng: item.lng },
            map,
            title: item.filename
          });

          const captionText = captions[index] || item.filename;

          const content = `
            <div class="info-content">
              <strong>${captionText}</strong>
              <br>
              <img src="images/${item.filename}" alt="${item.filename}">
            </div>
          `;

          marker.addListener("click", () => {
            infoWindow.setContent(content);
            infoWindow.open(map, marker);
          });
        });
      }
    </script>
    <script async
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC43l4vgqwlHsWX7XiWzzTkBnGLlLSf1fQ&callback=initMap">
    </script>
  </body>
</html>
